<ng-template #activityContent>
  <div class="gantt-activity__content">
    @if (showTitle) {
      <span class="gantt-activity__title">{{ effectiveTitle }}</span>
    }
    @if (shouldShowRoute) {
      <span class="gantt-activity__route">
        {{ activity.from ?? '—' }} → {{ activity.to ?? '—' }}
      </span>
    }
  </div>
</ng-template>

<div
  class="gantt-activity"
  role="button"
  tabindex="0"
  cdkDrag
  cdkDragPreviewContainer="global"
  [cdkDragData]="dragData"
  [ngClass]="hostClasses"
  [style.left.px]="leftPx"
  [style.width.px]="widthPx"
  [attr.aria-label]="ariaLabel"
  [matTooltip]="tooltipText"
  matTooltipClass="gantt-activity__tooltip"
  matTooltipShowDelay="180"
  (click)="handleClick($event)"
  (dblclick)="handleDoubleClick($event)"
  (keydown.enter)="handleKeyboardActivate($event)"
  (keydown.space)="handleKeyboardActivate($event)"
  (pointerdown)="handlePointerDown($event)"
  (pointermove)="handlePointerMove($event)"
  (pointerup)="handlePointerEnd($event)"
  (pointercancel)="handlePointerEnd($event)"
  (pointerleave)="handlePointerEnd($event)"
  (cdkDragStarted)="onDragStarted($event)"
  (cdkDragMoved)="onDragMoved($event)"
  (cdkDragEnded)="onDragEnded($event)"
>
  <ng-container [ngTemplateOutlet]="activityContent"></ng-container>
</div>

<ng-template cdkDragPreview>
  <div class="gantt-activity gantt-activity--preview" [ngClass]="hostClasses" [style.width.px]="widthPx">
    <ng-container [ngTemplateOutlet]="activityContent"></ng-container>
  </div>
</ng-template>

<ng-template cdkDragPlaceholder>
  <div class="gantt-activity gantt-activity--placeholder" [style.left.px]="leftPx" [style.width.px]="widthPx"></div>
</ng-template>
