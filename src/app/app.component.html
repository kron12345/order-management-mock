<mat-sidenav-container class="layout">
  @if (section() === 'manager') {
    <mat-sidenav class="sidenav" mode="side" opened>
      <div class="brand">
        <mat-icon>assignment</mat-icon>
        <span>Auftragsmanager</span>
      </div>

      <mat-nav-list>
        <a mat-list-item routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
          <mat-icon matListItemIcon>list_alt</mat-icon>
          <span matListItemTitle>Aufträge</span>
          <span matListItemLine>Übersicht & Bearbeitung</span>
        </a>
        <a mat-list-item routerLink="/businesses" routerLinkActive="active">
          <mat-icon matListItemIcon>work_outline</mat-icon>
          <span matListItemTitle>Geschäfte</span>
          <span matListItemLine>Aufgaben & Fälligkeiten</span>
        </a>
        <a mat-list-item routerLink="/templates" routerLinkActive="active">
          <mat-icon matListItemIcon>schema</mat-icon>
          <span matListItemTitle>Vorlagen</span>
          <span matListItemLine>Fahrpläne & Kalender</span>
        </a>
        <a mat-list-item routerLink="/plans" routerLinkActive="active">
          <mat-icon matListItemIcon>train</mat-icon>
          <span matListItemTitle>Fahrpläne</span>
          <span matListItemLine>Züge & Path Requests</span>
        </a>
      </mat-nav-list>
    </mat-sidenav>
  }

  <mat-sidenav-content class="content" [class.content--full]="section() !== 'manager'">
    <mat-toolbar class="toolbar" color="primary">
      <div class="toolbar-brand">
        <mat-icon>assignment</mat-icon>
        <div class="toolbar-brand-text">
          <span class="brand-title">{{ sectionTitle() }}</span>
          @if (showSubtitle()) {
            <small class="brand-subtitle">{{ pageTitle() }}</small>
          }
        </div>
      </div>
      <nav class="primary-nav">
        <a mat-button routerLink="/" [class.active]="section() === 'manager'">
          Auftragsmanager
        </a>
        <button
          mat-button
          type="button"
          [class.active]="section() === 'planning'"
          [matMenuTriggerFor]="planningNavMenu"
          #planningMenuTrigger="matMenuTrigger"
          (mouseenter)="planningMenuTrigger.openMenu()"
        >
          Planung
          <mat-icon fontIcon="expand_more"></mat-icon>
        </button>
        <a mat-button routerLink="/master-data" [class.active]="section() === 'master-data'">
          Stammdaten
        </a>
        <a mat-button routerLink="/settings" [class.active]="section() === 'settings'">
          Einstellungen
        </a>
      </nav>
      <span class="spacer"></span>
      <button mat-icon-button matTooltip="Benachrichtigungen">
        <mat-icon>notifications</mat-icon>
      </button>
      <button mat-icon-button matTooltip="Profil">
        <mat-icon>account_circle</mat-icon>
      </button>
      <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Weitere Optionen">
        <mat-icon>more_vert</mat-icon>
      </button>
    </mat-toolbar>

    <div class="page" [class.page--wide]="section() === 'manager'">
      <router-outlet />
    </div>

    <mat-menu #menu="matMenu">
      <button mat-menu-item routerLink="/settings">
        <mat-icon>settings</mat-icon>Einstellungen
      </button>
      <button mat-menu-item disabled>
        <mat-icon>help_outline</mat-icon>Hilfe
      </button>
    </mat-menu>

    <mat-menu #planningNavMenu="matMenu">
      <button mat-menu-item routerLink="/planning" [queryParams]="{ stage: 'base' }">
        <mat-icon>layers</mat-icon>Basisplanung
      </button>
      <button mat-menu-item routerLink="/planning" [queryParams]="{ stage: 'operations' }">
        <mat-icon>precision_manufacturing</mat-icon>Betriebsplanung
      </button>
      <button mat-menu-item routerLink="/planning" [queryParams]="{ stage: 'dispatch' }">
        <mat-icon>support_agent</mat-icon>Disposition
      </button>
    </mat-menu>
  </mat-sidenav-content>
</mat-sidenav-container>
